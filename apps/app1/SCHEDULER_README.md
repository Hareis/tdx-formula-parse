# 股票分析定时调度器使用说明

## 功能概述

这个定时调度器可以在每个工作日的交易时间内自动执行股票技术分析，每30分钟运行一次。

## 交易时间设置

- **上午**: 9:00-11:30 (执行时间: 9:00, 9:30, 10:00, 10:30, 11:00, 11:30)
- **下午**: 13:00-15:00 (执行时间: 13:00, 13:30, 14:00, 14:30, 15:00)
- **执行频率**: 每30分钟一次
- **执行日期**: 仅在周一到周五执行
- **Cron表达式**: 
  - 上午: `0,30 9-11 * * 1-5`
  - 下午: `0,30 13-15 * * 1-5`

## 使用方法

### 1. 即时执行测试

```bash
# 执行一次股票分析测试
npx tsx apps/app1/index.ts
```

### 2. 启动定时调度器

```bash
# 启动定时调度模式，将持续在交易时间运行
npx tsx apps/app1/index.ts schedule
```

### 3. 停止调度器

在调度器运行时，按 `Ctrl+C` 停止所有定时任务。

## 当前配置

- **分析股票**: 士兰微 (1.600460)
- **数据范围**: 2024年全年
- **技术指标**: 5日移动平均线 (从 `apps/app1/指标.txt` 读取)
- **数据源**: 东方财富网

## 输出信息

每次执行时会输出：
- 执行时间戳
- 股票代码
- 分析结果数据长度
- 最近5个有效计算值

示例输出：
```
[2025/11/18 13:58:37] 股票 1.600460 分析完成:
- 结果数据长度: 242
- 最近5个有效值: [ 12.34, 12.56, 12.78, 12.90, 13.02 ]
```

## 自定义配置

如需修改股票代码、分析周期或技术指标，请编辑 `apps/app1/index.ts` 文件中的相关参数：

- `symbol`: 股票代码
- `startDate` 和 `endDate`: 数据时间范围
- `指标.txt`: 技术指标公式文件

## 依赖要求

- Node.js
- TypeScript
- node-schedule 包 (已安装)
- @types/node-schedule 包 (已安装)

## 注意事项

1. 确保在交易时间之外启动调度器，否则下次执行会等到下一个交易时间点
2. 调度器会持续运行直到手动停止
3. 每次执行都会重新从东方财富网获取最新数据
4. 网络连接异常会导致任务执行失败，但不会影响后续定时任务